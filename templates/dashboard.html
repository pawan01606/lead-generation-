{% extends "base.html" %}
{% block content %}
  <div class="d-flex justify-content-between align-items-center mb-2">
    <h3>All Leads</h3>
    {% if current_user.role == 'admin' %}
      <a class="btn btn-primary" href="{{ url_for('add_lead') }}">Add Lead</a>
    {% endif %}
  </div>

  <table class="table table-striped table-bordered">
    <thead class="table-light"><tr>
      <th>ID</th><th>Branch</th><th>Customer</th><th>Contact</th><th>Lead Source</th><th>Loan Amount</th><th>Follow-up</th><th>Actions</th>
    </tr></thead>
    <tbody>
    {% for lead in leads %}
      <tr>
        <td>{{ lead.id }}</td>
        <td>{{ lead.branch_name }}</td>
        <td>{{ lead.customer_name }}</td>
        <td>{{ lead.contact_no }}</td>
        <td>{{ lead.lead_source }}</td>
        <td>{{ lead.loan_amount }}</td>
        <td>
          {{ lead.follow_up_date or '-' }}<br/>
          <small>{{ lead.current_status or '' }}</small>
        </td>
        <td>
          <a class="btn btn-sm btn-outline-primary" href="{{ url_for('view_lead', lead_id=lead.id) }}">View</a>
          <a class="btn btn-sm btn-outline-secondary" href="{{ url_for('edit_followup', lead_id=lead.id) }}">Edit FollowUp</a>
          {% if current_user.role == 'admin' %}
            <a class="btn btn-sm btn-outline-warning" href="{{ url_for('edit_lead', lead_id=lead.id) }}">Edit</a>
          {% endif %}
        </td>
      </tr>
    {% endfor %}
    </tbody>
  </table>
{% endblock %}
